var XdRsData=XdRsData||{};XdRsData.eventName={};XdRsData.eventName.displayActorName=eval(PluginManager.parameters("XdRs_EventName")["displayActorName"]);Game_Character.prototype.currentDisplayName=function(){return this._displayName||""};Game_Character.prototype.nameCompensateObj=function(){return null};Game_Character.prototype.compensateX=function(){const obj=this.nameCompensateObj();if(!obj)return 0;return+(obj.meta.NPX||0)};Game_Character.prototype.compensateY=function(){const obj=this.nameCompensateObj();if(!obj)return 0;return+(obj.meta.NPY||0)};Game_Player.prototype.currentDisplayName=function(){if(!XdRsData.eventName.displayActorName)return"";return $gameParty.leader()?$gameParty.leader().name():""};Game_Player.prototype.nameCompensateObj=function(){return $gameParty.leader()?$gameParty.leader().actor():null};Game_Follower.prototype.currentDisplayName=function(){if(!XdRsData.eventName.displayActorName)return"";return this.actor()?this.actor().name():""};Game_Follower.prototype.nameCompensateObj=function(){return this.actor()?this.actor().actor():null};XdRsData.eventName._Game_Event_setupPage=Game_Event.prototype.setupPage;Game_Event.prototype.setupPage=function(){XdRsData.eventName._Game_Event_setupPage.call(this);this.setupDisplayName()};Game_Event.prototype.setupDisplayName=function(){this._displayName="";if(this.list()&&this.list()[0].code===108){if(this.list()[0].parameters[0].match(/<Name:([\S\s]*)>/)){this._displayName=RegExp.$1}}};Game_Event.prototype.nameCompensateObj=function(){return this.event()};function Window_EventName(){this.initialize(...arguments)}Window_EventName.prototype=Object.create(Window_Base.prototype);Window_EventName.prototype.constructor=Window_EventName;Window_EventName.prototype.initialize=function(){Window_Base.prototype.initialize.call(this,new Rectangle(0,0,32,32));this.opacity=0;this.hide()};Window_EventName.prototype.updatePadding=function(){this.padding=0};Window_EventName.prototype.setup=function(){this._lastName=this.parent.displayName();this.width=this.currentWindowWidth();this.height=this.lineHeight();this.createContents();this.drawEventName()};Window_EventName.prototype.currentWindowWidth=function(){if(!this._lastName)return 32;return this.textSizeEx(this._lastName).width+8};Window_EventName.prototype.drawEventName=function(){if(!this._lastName)return this.hide();else{this.drawTextEx(this._lastName,2,0,this.width/12);this.show()}};Window_EventName.prototype.update=function(){Window_Base.prototype.update.call(this);this._lastName!==this.parent.displayName()&&this.setup();this.updatePosition()};Window_EventName.prototype.updatePosition=function(){if(!this.visible)return;const cx=this.parent._character.compensateX();const cy=this.parent._character.compensateY()+56;this.x=-this.width/2+cx;this.y=-(this.parent.patternHeight()+this.height)+cy};XdRsData.eventName._Sprite_Character_setCharacter=Sprite_Character.prototype.setCharacter;Sprite_Character.prototype.setCharacter=function(character){XdRsData.eventName._Sprite_Character_setCharacter.call(this,character);this.updateBitmap();this.cretaeEventName()};Sprite_Character.prototype.cretaeEventName=function(){this._eventName=new Window_EventName;this.addChild(this._eventName)};Sprite_Character.prototype.displayName=function(){return this._character?this._character.currentDisplayName():""};