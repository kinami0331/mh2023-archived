(function(){TouchInput.clear=function(){this._mousePressed=false;this._screenPressed=false;this._pressedTime=0;this._events={};this._events.triggered=false;this._events.cancelled=false;this._events.moved=false;this._events.released=false;this._events.wheelX=0;this._events.wheelY=0;this._triggered=false;this._cancelled=false;this._moved=false;this._released=false;this._wheelX=0;this._wheelY=0;this._x=0;this._y=0;this._date=0;this.Gesture_clear()};TouchInput._onTrigger=function(x,y){this._events.triggered=true;this._x=x;this._y=y;this._date=Date.now();this.startGesture(x,y)};TouchInput._onCancel=function(x,y){this._events.cancelled=true;this._x=x;this._y=y;this.stopGesture(x,y)};TouchInput._onMove=function(x,y){this._events.moved=true;this._x=x;this._y=y;this.progressGesture(x,y)};TouchInput._onRelease=function(x,y){this._events.released=true;this._x=x;this._y=y;this.stopGesture(x,y)};TouchInput.Gesture_clear=function(){this._Gesture_last_dChain=[];this._Gesture_last_time=0;this._Gesture_directionChain=[];this._Gesture_time=0;this._Gesture_lastX=0;this._Gesture_lastY=0;var fx=parseInt(PluginManager.parameters("ww_Gesture")["fx"],10);if(isFinite(fx)&&[0,4,8].contains(fx)){this._Gesture_fx=fx}else{this._Gesture_fx=4}var fx0=PluginManager.parameters("ww_Gesture")["fx0"];if(fx0!=""){this._Gesture_fx0=JSON.parse(fx0)}else{this._Gesture_fx0=[]}var sjshuru=parseInt(PluginManager.parameters("ww_Gesture")["sjshuru"],10);if(isFinite(sjshuru)&&[0,1].contains(sjshuru)){this._Gesture_sjshuru=sjshuru}else{this._Gesture_sjshuru=0}var wzshuru=parseInt(PluginManager.parameters("ww_Gesture")["wzshuru"],10);if(isFinite(wzshuru)&&[0,1].contains(wzshuru)){this._Gesture_wzshuru=wzshuru}else{this._Gesture_wzshuru=0}var wzjiange=parseInt(PluginManager.parameters("ww_Gesture")["wzjiange"],10);if(isFinite(wzjiange)&&wzjiange>0){this._Gesture_wzjiange=wzjiange}else{this._Gesture_wzjiange=100}var sjjiange=parseInt(PluginManager.parameters("ww_Gesture")["sjjiange"],10);if(isFinite(sjjiange)&&sjjiange>0){this._Gesture_sjjiange=sjjiange}else{this._Gesture_sjjiange=1}var fangshi=parseInt(PluginManager.parameters("ww_Gesture")["fangshi"],10);if(isFinite(fangshi)&&[0,1,2,3].contains(fangshi)){this._Gesture_fangshi=fangshi}else{this._Gesture_fangshi=0}var jishi=parseInt(PluginManager.parameters("ww_Gesture")["jishi"],10);if(isFinite(jishi)&&[0,1,2].contains(jishi)){this._Gesture_jishi=jishi}else{this._Gesture_jishi=0}};TouchInput.startGesture=function(x,y){this._Gesture_lastX=x;this._Gesture_lastY=y;this._Gesture_time=0;this._Gesture_directionChain=[]};TouchInput.progressGesture=function(x,y){this._Gesture_time++;if(this._Gesture_sjjiange>0){if(this._Gesture_time.mod(this._Gesture_sjjiange)!=0){this.Gesture_sjshuru(x,y);return}}var x1=this._Gesture_lastX;var y1=this._Gesture_lastY;var x2=x;var y2=y;var wzjiange=this._Gesture_wzjiange;var jiaodu;var direction;this.Gesture_wzshuru(x,y);var fx=this._Gesture_fx;if(fx==4){direction=this.Gesture_4d(x1,y1,x2,y2,wzjiange)}else{jiaodu=this.Gesture_jd(x1,y1,x2,y2,wzjiange);if(!isFinite(jiaodu)){return}if(fx==8){direction=this.Gesture_8d(jiaodu)}else{direction=this.Gesture_0d(jiaodu)}}if(!isFinite(direction)){return}this.Gesture_push(direction);this._Gesture_lastX=x;this._Gesture_lastY=y};TouchInput.stopGesture=function(x,y){this._Gesture_last_time=this._Gesture_time;this._Gesture_last_dChain=this._Gesture_directionChain;this._Gesture_directionChain=[];this._Gesture_time=0;this._Gesture_lastX=x;this._Gesture_lastY=y};TouchInput.Gesture_sjshuru=function(x,y){if(this._Gesture_sjshuru==1){this._Gesture_lastX=x;this._Gesture_lastY=y}};TouchInput.Gesture_wzshuru=function(x,y){if(this._Gesture_wzshuru==1){this._Gesture_lastX=x;this._Gesture_lastY=y}};TouchInput.Gesture_4d=function(x1,y1,x2,y2,wzjiange){var x=x2;var y=y2;var lastX=x1;var lastY=y1;var wzjiange=wzjiange;var subX=x-lastX;var subY=y-lastY;var distX=subX>0?subX:-subX;var distY=subY>0?subY:-subY;var direction;if(distX<wzjiange&&distY<wzjiange)return;if(distX>distY){direction=subX<0?4:6}else{direction=subY<0?8:2}return direction};TouchInput.Gesture_jd=function(x1,y1,x2,y2,wzjiange){var subx=Math.abs(x1-x2);var suby=Math.abs(y1-y2);var subz2=subx*subx+suby*suby;if(subz2<wzjiange*wzjiange){return}if(x2-x1==0&&y2-y1==0){return}else if(x2-x1==0){if(y1-y2>0){jiaodu=90}else if(y1-y2<0){jiaodu=270}}else if(y2-y1==0){if(x2-x1>0){jiaodu=0}else if(x2-x1<0){jiaodu=180}}else{var subz=Math.sqrt(subz2);var jiaodu=Math.asin(suby/subz)/Math.PI*180;if(x2-x1>0&&y1-y2>0){jiaodu=jiaodu.mod(360)}else if(x2-x1>0&&y1-y2<0){jiaodu=(-jiaodu).mod(360)}else if(x2-x1<0&&y1-y2<0){jiaodu=(180+jiaodu).mod(360)}else if(x2-x1<0&&y1-y2>0){jiaodu=(180-jiaodu).mod(360)}}return jiaodu};TouchInput.Gesture_8d=function(jiaodu){var direction;var jiaodu=jiaodu.mod(360);var dirs=[6,9,8,7,4,1,2,3,6];var dirjd=[0,45,90,135,180,225,270,315,360];for(var id=0;id<dirjd.length;id++){if(Math.abs(dirjd[id]-jiaodu)<=22.5){direction=dirs[id];return direction}}return direction};TouchInput.Gesture_0d=function(jiaodu){var direction;var jiaodu=jiaodu.mod(360);var dirjd=this._Gesture_fx0;for(var id=0;id<dirjd.length;id++){if(jiaodu>=dirjd[id][1].mod(360)&&jiaodu<=dirjd[id][2].mod(360)){direction=dirjd[id][0];return direction}}return direction};TouchInput.Gesture_push=function(direction){if(direction!=this._Gesture_directionChain[this._Gesture_directionChain.length-1]){this._Gesture_directionChain.push(direction)}};TouchInput.Gesture=function(gt){var jishi=this._Gesture_jishi;var gesture;var gesture2;if(jishi==1||jishi==0){gesture=this._Gesture_directionChain.clone();gesture2=gt.clone();if(this.Gesture_true(gesture,gesture2)){return true}}if(jishi==2||jishi==0){gesture=this._Gesture_last_dChain.clone();gesture2=gt.clone();if(this.Gesture_true(gesture,gesture2)){return true}}return false};TouchInput.Gesture_true=function(gesture,gesture2){var fangshi=this._Gesture_fangshi;if(gesture.join()!=""&&gesture2.join()!=""){if(fangshi==0){if(gesture.join()==gesture2.join()){return true}}if(fangshi==1){gesture.reverse();gesture2.reverse();if(gesture.join().indexOf(gesture2.join())==0){return true}}if(fangshi==2){if(gesture.join().indexOf(gesture2.join())==0){return true}}if(fangshi==3){if(gesture.join().indexOf(gesture2.join())>=0){return true}}}return false}})();