(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8513],{33761:function(e,t,n){Promise.resolve().then(n.bind(n,62824))},62824:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var r=n(35029),a=n(24670),u=n(57437),s=n(59666),i=n(59781),c=n(41926),o=n(6596),f=n(88110),d=n.n(f),l=n(33116),_=n(36295),m=n(68939),h=n(24033),v=n(2265),x=n(7775),p=n(15754),g=n(35239),j=n(54477);function y(){var e=(0,s.F)({endpoint:"staff/get_team_list"}),t=e.data,n=e.mutate,f=(0,h.useRouter)(),y=(0,v.useContext)(x.s),C=y.staffUnreadOnly,k=y.setStaffUnreadOnly,S=y.staffTimeDesc,w=y.setStaffTimeDesc,E=(0,a._)((0,p.q)(3),3),N=(E[0],E[1]),D=E[2],R=(0,a._)(l.ZP.useMessage(),2),I=R[0],b=R[1];if(!t)return(0,u.jsx)(g.g,{});if("success"!==t.status)throw new j.Dc(t.message,t.title);var A=[{title:"id",dataIndex:"team_id",key:"team_id"},{title:"队名",dataIndex:"team_name",key:"team_name"},{title:"最后一次消息",dataIndex:"last_msg_ts",key:"last_msg_ts",render:function(e,t){return(0,u.jsxs)("span",{children:[t.unread?(0,u.jsx)(c.Z,{twoToneColor:"#eb2f96"}):(0,u.jsx)(i.Z,{twoToneColor:"#52c41a"}),"\xa0\xa0",null===e?"---":new Date(1e3*e).toLocaleString()]})}},{title:"操作",key:"action",render:function(e,t){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d(),{type:"link",onClick:function(){return f.push("/staff/message?tid=".concat(t.team_id))},children:"回复站内信"}),(0,u.jsx)(d(),{type:"link",onClick:function(){return f.push("/staff/team-detail?tid=".concat(t.team_id))},children:"队伍详情"})]})}}];return(0,u.jsxs)("div",{children:[b,(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsx)("div",{children:(0,u.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:["\xa0仅显示未回复信息：",(0,u.jsx)(_.Z,{defaultChecked:C,onChange:function(){return k(!C)}}),(0,u.jsxs)(u.Fragment,{children:["\xa0\xa0\xa0时间降序：",(0,u.jsx)(_.Z,{defaultChecked:S,onChange:function(){return w(!S)}})]})]})}),(0,u.jsxs)(d(),{type:"link",ref:D,onClick:function(){I.success({content:"已刷新",key:"TeamManage.LoadData",duration:1}).then(),N(),n().then()},children:[(0,u.jsx)(o.Z,{})," 刷新"]})]}),(0,u.jsx)(m.Z,{columns:A,scroll:{x:"max-content"},dataSource:t.data.sort(S?function(e,t){return t.last_msg_ts-e.last_msg_ts}:function(e,t){return e.team_id-t.team_id}).filter(function(e){return!C||e.unread}).map(function(e){return(0,r._)({key:e.team_id},e)})})]})}function C(){return(0,u.jsx)(y,{})}},35239:function(e,t,n){"use strict";n.d(t,{g:function(){return u}});var r=n(57437),a=n(26782);function u(){return(0,r.jsx)("div",{children:(0,r.jsx)(a.default,{active:!0,paragraph:!0})})}},54477:function(e,t,n){"use strict";n.d(t,{$v:function(){return o},Dc:function(){return f},_e:function(){return c},sF:function(){return i}});var r=n(22977),a=n(6408),u=n(56417),s=n(93891),i=function(e){(0,a._)(n,e);var t=(0,s._)(n);function n(e){var a;return(0,r._)(this,n),(a=t.call(this,e||"")).name="NeverError",a}return n}((0,u._)(Error)),c=function(e){(0,a._)(n,e);var t=(0,s._)(n);function n(e){var a;return(0,r._)(this,n),(a=t.call(this,e||"")).name="InfoError",a}return n}((0,u._)(Error)),o=function(e){(0,a._)(n,e);var t=(0,s._)(n);function n(e){var a;return(0,r._)(this,n),(a=t.call(this,e||"")).name="NotStaffError",a}return n}((0,u._)(Error)),f=function(e){(0,a._)(n,e);var t=(0,s._)(n);function n(e,a){var u;return(0,r._)(this,n),(u=t.call(this,e||"")).name="DataError",u.title=a,u}return n}((0,u._)(Error))},15754:function(e,t,n){"use strict";n.d(t,{q:function(){return a}});var r=n(2265);function a(e){var t=(0,r.useRef)(+new Date),n=(0,r.useRef)(null);return(0,r.useEffect)(function(){t.current=+new Date},[]),[t.current/1e3,function(){n.current&&(n.current.disabled=!0),t.current=+new Date,setTimeout(function(){+new Date-t.current>=1e3*e-200&&n.current&&(n.current.disabled=!1)},1e3*e)},n]}},43194:function(e,t,n){"use strict";n.d(t,{$3:function(){return f},_s:function(){return c},ei:function(){return d},t3:function(){return o}});var r=n(57437),a=n(2265),u=n(59666),s=n(35239),i=n(54477),c=(0,a.createContext)(void 0);function o(e){var t=e.children,n=(0,u.L)({endpoint:"game/game_info"}),a=n.data,i=n.mutate;return a?(0,r.jsx)(c.Provider,{value:{info:a,reloadInfo:i},children:t}):(0,r.jsx)(s.g,{})}function f(){return(0,a.useContext)(c).info}function d(){var e=f();if("success"!==e.status)throw new i._e;return e}},7775:function(e,t,n){"use strict";n.d(t,{E:function(){return f},s:function(){return o}});var r=n(24670),a=n(57437),u=n(2265),s=n(67912),i=n(38225),c=n(43194),o=(0,u.createContext)(void 0);function f(e){var t=e.children,n=(0,r._)((0,u.useState)(!1),2),f=n[0],d=n[1],l=(0,r._)((0,u.useState)(!1),2),_=l[0],m=l[1],h=(0,r._)((0,u.useState)(!1),2),v=h[0],x=h[1],p=(0,r._)((0,u.useState)(!1),2),g=p[0],j=p[1],y=(0,r._)((0,u.useState)(!1),2),C=y[0],k=y[1],S=(0,r._)((0,u.useState)(!1),2),w=S[0],E=S[1],N=(0,r._)((0,u.useState)(!1),2),D=N[0],R=N[1],I=(0,r._)((0,u.useState)(0),2),b=I[0],A=I[1],Z=(0,r._)((0,u.useState)(0),2),O=Z[0],P=Z[1],T=(0,r._)((0,u.useState)(0),2),F=T[0],H=T[1],z=(0,r._)((0,u.useState)([[0,0]]),2),L=z[0],M=z[1],U=(0,c.ei)(),J=(0,u.useCallback)(function(){(0,s.HC)({endpoint:"game/team_ap_detail"}).then(function(e){if("error"!==e.status){var t=e.data.team_ap_change,n=e.data.ap_increase_policy;JSON.stringify(n)!==JSON.stringify(L)&&M(n),H(t),A((0,i.Rp)(n,t)),P((0,i.Jy)(n))}})},[L]),q=(0,u.useCallback)(function(){L&&A((0,i.Rp)(L,F))},[F,L]),$=(0,u.useRef)(J);return(0,u.useEffect)(function(){U.user&&U.team&&"staff"!==U.user.group&&$.current()},[U,$]),(0,u.useEffect)(function(){if(U.user&&U.team&&"staff"!==U.user.group){var e=setInterval(q,2e4);return function(){clearInterval(e)}}},[U,q]),(0,a.jsx)(o.Provider,{value:{needReloadAnnouncement:f,setNeedReloadAnnouncement:d,hasNewAnnouncement:g,setHasNewAnnouncement:j,staffUnreadOnly:C,setStaffUnreadOnly:k,staffTimeDesc:w,setStaffTimeDesc:E,hasNewMessage:D,setHasNewMessage:R,needReloadPuzzle:_,setNeedReloadPuzzle:m,needReloadArea:v,setNeedReloadArea:x,currentAp:b,currentApIncrease:O,updateCurrentAp:J},children:t})}},59666:function(e,t,n){"use strict";n.d(t,{F:function(){return s},L:function(){return u}});var r=n(42333),a=n(67912);function u(e){var t=(0,r.ZP)(e,function(e){return(0,a.HC)(e)},{refreshInterval:18e5});return{data:t.data,mutate:t.mutate}}function s(e){var t=(0,r.ZP)(e,function(e){return(0,a.HC)(e)});return{data:t.data,mutate:t.mutate}}}},function(e){e.O(0,[5583,4410,6857,6126,5193,6559,5682,8110,8051,2044,3706,6744,4840,9397,5602,3116,6413,9189,5700,8939,2891,2169,2971,7864,1744],function(){return e(e.s=33761)}),_N_E=e.O()}]);